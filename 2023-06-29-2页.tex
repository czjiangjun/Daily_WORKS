%---------------------- TEMPLATE FOR REPORT ------------------------------------------------------------------------------------------------------%

%\thispagestyle{fancy}   % 插入页眉页脚                                        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 用 authblk 包 支持作者和E-mail %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\title{More than one Author with different Affiliations}				     %
%\title{\rm{VASP}的电荷密度存储文件\rm{CHGCAR}}
%\title{面向高温合金材料设计的计算模拟软件中的几个主要问题}
\title{面向高温合金材料模拟的计算方法发展和创新研究}
\author[ ]{姜~骏}   %
%\author[ ]{姜~骏\thanks{jiangjun@bcc.ac.cn}}   %
%\affil[ ]{北京市计算中心}    %
%\author[a]{Author A}									     %
%\author[a]{Author B}									     %
%\author[a]{Author C \thanks{Corresponding author: email@mail.com}}			     %
%%\author[a]{Author/通讯作者 C \thanks{Corresponding author: cores-email@mail.com}}     	     %
%\author[b]{Author D}									     %
%\author[b]{Author/作者 D}								     %
%\author[b]{Author E}									     %
%\affil[a]{Department of Computer Science, \LaTeX\ University}				     %
%\affil[b]{Department of Mechanical Engineering, \LaTeX\ University}			     %
%\affil[b]{作者单位-2}			    						     %
											     %
%%% 使用 \thanks 定义通讯作者								     %
											     %
\renewcommand*{\Authfont}{\small\rm} % 修改作者的字体与大小				     %
\renewcommand*{\Affilfont}{\small\it} % 修改机构名称的字体与大小			     %
\renewcommand\Authands{ and } % 去掉 and 前的逗号					     %
\renewcommand\Authands{ , } % 将 and 换成逗号					     %
\date{} % 去掉日期									     %
%\date{2020-12-30}									     %

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  不使用 authblk 包制作标题  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%-------------------------------The Title of The Report-----------------------------------------%
%\title{报告标题:~}   %
%-----------------------------------------------------------------------------

%----------------------The Authors and the address of The Paper--------------------------------%
%\author{
%\small
%Author1, Author2, Author3\footnote{Communication author's E-mail} \\    %Authors' Names	       %
%\small
%(The Address，City Post code)						%Address	       %
%}
%\affil[$\dagger$]{清华大学~材料加工研究所~A213}
%\affil{清华大学~材料加工研究所~A213}
%\date{}					%if necessary					       %
%----------------------------------------------------------------------------------------------%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\maketitle
%\thispagestyle{fancy}   % 首页插入页眉页脚 
\section{引言}
镍基单晶高温合金是航空发动机核心部件的主要材料，其组分多元且结构复杂，通常的材料计算软件很难模拟合此类金材料的力学和热力学行为。改进和创新复杂合金的模拟策略，发展适合高温合金材料设计的多学科融合研究方式已成为高温合金材料研究的当务之急。
%以及针对主要计算工具维也纳原子模拟软件包~(\textrm{VASP})~在原子、电子层次计算的特点，在加速计算方面做必要的发展。此外，鉴于合金材料中有大量含有~\textit{d}-电子的金属元素，由于\textit{d}-电子的对称性复杂，大量的\textit{d}电子使得能带结构的复杂度显著增加;~在高精度计算中，合金中重元素的旋-轨耦合效应也将难以忽略，有必要从计算方法层次考虑计算这部分贡献对体系性能的影响。 在此基础上，我们才有望完整考虑单晶高温合金材料的电子能带结构及其与晶格的相互作用，确定材料的基本特性，进而研究材料在高温条件下产生的物理效应，揭示其物理机理的深刻内涵。

\section{维也纳原子模拟软件的计算优势}
在材料模拟软件领域，维也纳原子模拟软件是性能最优异的微观模拟软件之一，其采用的投影子缀加波\textrm{(PAW)}方法，较好地平衡了计算精度和效率;~软件应用了大量的优化算法，有效地保证了矩阵对角化和自洽迭代的快速收敛及稳定性。高温合金材料的设计更多的关注体系的热力学与结构性质，维也纳原子模拟软件的多层次优化算法支持的迭代收敛的特色，为相关材料热力学与力学参数的计算提供了保障。%对于简单材料模拟，维也纳原子模拟软件的计算能力足以支持，但是对单晶高温合金这样的复杂体系模拟，还需要从计算方法层面予以发展，提升软件对单晶高温合金的计算效率。单晶高温合金模拟的高精度计算主要是电子结构和从头计算分子动力学的自洽迭代，除了其已支持的共轭梯度等经典的优化算法，有必要引入包括随机梯度下降优化算法和机器学习算法(如神经网络)在内的多种优化算法，实现复杂模型的自洽迭代快速稳定收敛。

维也纳原子模拟软件的通信接口(\textrm{MPI})并行扩展性有突出的表现，通用计算机上在上百核都能有良好的的并行线性度。该软件在通信接口并行的基础上，引入轮询调度算法\textrm{(Round-Robin Scheduling)}，实现计算资源分配的均衡。计算中自洽迭代是资源消耗的主要部分，该软件的优化算法通过约束对角化矩阵的规模，限制节点间通信，保证了通信的效率和扩展性，软件的并行上限可突破256核。但在超过500核的并行环境下，软件的并行效率下降比较明显。如能对并行系统与维也纳原子模拟软件结合作深度改造，并行扩展有望达到$10^4$核级别。计算中存在大量快速傅立叶变换(\textrm{Fast Fourier Transform})，内存开销很大，如能从算法层面降低傅立叶变换的存储和通信，有助于提升软件的并行效能，提高软件处理合金模型的能力。
%由数据结构出发，构建支撑数据到计算资源的均衡负载的软件框架，将有望系统地提升材料计算核心软件的并行能力和扩展性，从而提升软件处理更大规模计算模型的能力。针对\ch{Ni}-基单晶高温合金材料的模拟，考虑到模型的复杂度(过渡金属原子多、原子成分变化大)，软件框架的开发将重点解决软件的并行扩展性问题，通过建立以密度矩阵理论为基础的线性标度算法及软件框架，原理性改变哈密顿矩阵结构，优化作业并行效率n。

\section{投影子缀加波方法和\textit{d}-电子计算}
高温合金材料中除了铝元素外，是大量含有\textit{d}-电子的过渡元素。虽然\textit{d}-电子较局域，表观上不易成键，但由于\textit{d}-电子的轨道形态丰富，合金中金属原子堆积紧密，因此\textit{d}-电子间成键比金属原子-非金属原子的成键容易。高温合金原子间电荷密度分布分析表明金属原子间的电荷密度的组分，有明显的\textit{d}-电子的贡献。高温合金中的过渡元素种类丰富，而不同原子的\textit{d}-电子的含量不同，因此必须对体系进行高精度的第一原理计算，解析\textit{d}-电子成键的组分贡献，为高温合金材料的性能提升提供支持。

投影子缀加波方法在平面波基组中，在原子核附近引入价电子波函数，扩展变分空间，对材料价电子行为描述更精确。借助投影函数，波函数在实空间和倒空间的变换变得方便。对于含有\textit{d}-电子的过渡金属，投影子缀加波方法较好地克服了传统赝势-平面波方法描述局域轨道的不足，保证了对\textit{d}-电子的精确描述。

\section{结构对称性的技术分析和程序设计实现空间群计算}
对称性伴随的是系统在变换过程中物理量的守恒，利用对称性，能在有限条件下获得更多物理信息。材料学研究的理想模型采用周期边界条件，根据晶体学理论，平移对称性与点群对称性相互约束，将周期体系划分为32个点群和230个空间群。对于高温合金材料而言，因为组成元素及其组分比较复杂，为合理反映微量元素的影响，设计的合金模型须足够大。计算规模也超过一般材料模拟，这是高温合金模拟的主要困难之一。如何利用体系的晶体对称性，有效地降低计算规模、提升模拟计算的能力，建立微观空间对称划分与宏观材料性质的关系，是研究中的重要问题。

在之前工作中，通过对维也纳原子模拟软件的核心代码剖析，我们注意到软件的对称性分析功能只有点群模块，缺少晶体空间群模块，我们从晶体学理论出发，按照点群-空间群生成对应法则，编写了全部空间群生成代码，完善了软件的晶体原子和空间对称性分析功能。空间群功能的引入，更有效地确定多组元复杂模型微观空间结构与宏观力学特性的关系，简化高温合金材料的力学性质模拟。

\section{能带计算}
在微观层次上，材料的电子结构与体系的空间对称性同样密切关联。表示材料电子结构的能带反映了体系中电子能量沿高对称方向的色散关系。软件模拟电子结构时，绘制能带图示所需的高对称性$\vec k$~点方向的选择主要依靠经验和习惯，没有统一的规则，所以有很大的随意性。%\textrm{Setyawan}等\upcite{CMS49-299_2010}以\textrm{BCC}结构的\ch{GeF4}的能带为例，指出
如果选择$\vec k$~点路径时%中不包含\textrm{H}点，
高对称性点包含不完备，无法正确反映材料的电子的能量分布情况。高温合金材料的模拟，将面对大量复杂的能带，由于合金模型类似，能带也因对称性具有相似性。选择合理的电子能带表示路径，不仅方便模型的电子结构数据对比，也将方便数据挖掘技术在能带领域的应用。为规范电子结构计算中能带的表示，%\cite{CMS49-299_2010}
我们将能带表示的$\vec k$~点路径标准化方案集成到维也纳模拟软件中，不但提升现有软件的计算效率，也为数据挖掘技术应用于高温合金材料的电子结构解析提供了必要的基础。


\section{旋-轨耦合与高温合金}
当材料中含有重元素时，其价电子自旋与轨道角动量的相互作用，对体系的物理性质有较显著的影响，称为旋-轨耦合\textrm{(SOC)}效应。旋-轨耦合本质上是当原子核很重，电子在原子核附近运动速度接近光速时，相对论效应不能忽略引起的。高温合金材料中的过渡金属合金组分多且复杂，旋-轨耦合效应在$10^{-2}\sim10^{-1}\mathrm{eV}$范围内，在考虑电子结构时，一般不应忽略。热力学性质、力学性质等则主要取决于体系的原子-原子、分子-分子间相互作用，其大小范围在$1\sim10^3\mathrm{eV}$不等，比旋-轨耦合作用强得多，因此一般不考虑旋-轨耦合的贡献。所以对于高温合金材料，一个可行的方案是用标量相对论方法估计体系中旋-轨耦合贡献的大小，并与体系的原子/分子间相互作用势比较，如果两者数据接近，则旋-轨耦合效应不能忽略，否则在有关力学、热力学参数计算时，可暂时不予考虑。

\section{小结}
材料模拟与计算在第四代单晶高温合金的研发过程中，将起到重要的探索和牵引作用，如何有效地管理、分配和利用计算资源，是应用高通量自动流程方式计算需要重点考虑的问题。通过对核心计算软件的代码剖析、发展相关功能，我们对维也纳原子模拟软件有了较深入的掌握，重点围绕单晶高温合金材料计算模拟的复杂度，结合现有软件特点和计算方法的发展方向，提出主要面向单晶高温合金体系模拟计算物理和计算方法相融合发展的技术路线。
